var ScanditSDKProxy=function(){function e(){var e=Windows.Graphics.Display,t=e.DisplayInformation.getForCurrentView().currentOrientation;return t===e.DisplayOrientations.portrait||t===e.DisplayOrientations.portraitFlipped}function t(t){var n=t.viewfinderDimension;return e()?{width:n[0],height:n[1]}:{width:n[2],height:n[3]}}function n(t){return e()?t.portraitMargins:t.landscapeMargins}function i(e){var t=JSON.stringify(e),n=new BarcodeScannerPlugin.ScanSettingsProxy(t),i=e.scanningHotSpot;n.setScanningHotSpot(i.x,i.y);var r=e.activeScanningAreaPortrait;n.setActiveScanningAreaPortrait(r.x,r.y,r.width,r.height);var o=e.activeScanningAreaLandscape;return n.setActiveScanningAreaLandscape(o.x,o.y,o.width,o.height),n.setCameraFacing(e.cameraFacingPreference),n}function r(e){var t=Windows.Graphics.Display.DisplayInformation.getForCurrentView(),n=t.rawDpiX/t.logicalDpi,i=t.rawDpiY/t.logicalDpi;return{left:e[0]*n,right:e[2]*n,top:e[1]*i,bottom:e[3]*i}}function o(e,t){var n=r(t);e.style.margin=n.top+"px "+n.right+"px "+n.bottom+"px "+n.left+"px";var i=window.innerWidth,o=window.innerHeight;e.style.width=i-n.left-n.right+"px",e.style.height=o-n.top-n.bottom+"px"}function a(){var e={beep:!0,viewfinderColor:"#fff",viewfinderDecodedColor:"#fff",guiStyle:Scandit.ScanOverlay.GuiStyle.DEFAULT,viewfinderDimension:[.9,.4,.6,.4]};return e}function l(e,t){for(var n in e)e.hasOwnProperty(n)&&"function"!=typeof e[n]&&"picker"!==n&&"properties"!==n&&(t[n]=e[n])}function c(e,t,n,i,o){var a=r(e),l=window.innerWidth-a.left-a.right,c=window.innerHeight-a.top-a.bottom,s=(t.y-.5*n.height)*c,p=(t.x-.5*n.width)*l,d=n.width*l,u=n.height*c;i.style.top=s+"px",i.style.left=p+"px",i.style.width=d+"px",i.style.height=u+"px",o.style.top=s+u+"px",i.style.display=F.overlay.guiStyle==Scandit.ScanOverlay.GuiStyle.NONE?"none":"block",i.style.borderColor=F.overlay.viewfinderColor;var y=55;o.style.left=p+d-y+"px"}function s(t){if(null!=t.capture){var n=t.capture.videoWidth,i=t.capture.videoHeight;if(0!==n&&0!==i){if(e()){var r=n;n=i,i=r}var o,a,l=n/i,c=t.root.clientWidth/t.root.clientHeight;c>l?(o=t.root.clientWidth,a=Math.round(o/l)):(a=Math.round(t.root.clientHeight),o=a*l);var s=Math.floor((t.root.clientHeight-a)/2)+"px",p=Math.floor((t.root.clientWidth-o)/2)+"px";setTimeout(function(){t.preview&&(t.preview.style.width=o+"px",t.preview.style.height=a+"px",t.preview.style.margin=s+" "+p)},50),setTimeout(function(){t.preview&&(t.preview.style.height=a+.5+"px")},1e3)}}}function p(){C()}function d(){F.preview&&("hidden"===document.visibilityState&&F.running?(F.startOnWindowVisible=!0,w()):F.startOnWindowVisible&&(S({paused:F.paused}),F.startOnWindowVisible=!1))}function u(e){if(null!=F.capture){F.errorPanel.style.display="table",F.errorPanel.style.width=F.root.style.width,F.errorPanel.style.height=F.root.style.height,F.errorPanel.style.fontSize="200%";var t="display:table-cell;text-align:center;vertical-align:middle;opacity:1.0;";F.errorPanel.innerHTML='<div style="'+t+'">'+e+"</div>",F.viewFinder.style.display="none",F.logo.style.display="none"}}function y(){return-1!==navigator.appVersion.indexOf("MSAppHost/3.0")?!1:-1!==navigator.appVersion.indexOf("Windows Phone 8.1;")?!1:-1!==navigator.appVersion.indexOf("MSAppHost/2.0;")?!0:!1}function v(e){var t=999;if(e.root=document.createElement("div"),e.root.style.position="absolute",e.root.style.margin="0px",e.root.style.background="black",e.root.style.overflow="hidden",e.root.style.top="0px",e.root.style.left="0px",e.root.style.zIndex=t,e.errorPanel=document.createElement("div"),e.errorPanel.style.position="absolute",e.errorPanel.style.margin="0px",e.errorPanel.style.background="black",e.errorPanel.style.color="white",e.errorPanel.style.textAlign="center",e.errorPanel.style.verticalAlign="middle",e.errorPanel.style.opacity=.7,e.errorPanel.style.display="none",e.errorPanel.style.zIndex=t+1,e.errorPanel.style.padding="10px",e.errorPanel.innertHTML="One, two, three",e.root.appendChild(e.errorPanel),document.body.appendChild(e.root),e.preview=document.createElement("video"),e.preview.msZoom=!0,e.preview.style.background="black",e.preview.style.zIndex=t+1,e.root.appendChild(e.preview),e.logo=document.createElement("img"),e.logo.src="/www/img/scandit-logo.svg",e.logo.style.width="55px",e.logo.style.height="20px",e.logo.style.position="absolute",e.logo.style.zIndex=t+2,e.logo.msUserSelect="none",e.root.appendChild(e.logo),e.viewFinder=document.createElement("div"),e.viewFinder.style.zIndex=t+2,e.viewFinder.style.position="absolute",e.viewFinder.style.borderWidth="1px",e.viewFinder.style.borderStyle="solid",e.viewFinder.style.borderRadius="10px",e.root.appendChild(e.viewFinder),y()&&e.isFullScreen){var n=document.createElement("div");n.style.width="100%",n.style.background="black",n.style.opacity=.4,n.style.zIndex=t+2,n.style.color="white",n.style.color="white",n.style.fontSize="200%",n.style.textTransform="none",n.style.bottom="0px",n.style.left="0px",n.style.padding="5px",n.style.position="absolute",n.style.msUserSelect="none";var i=document.createElement("span");i.onclick=P,i.innerHTML="Cancel",n.appendChild(i),i.style.opacity=1,e.root.appendChild(n)}else n=null;e.beeper=document.createElement("audio");var r=document.createElement("source");r.src="/www/wav/scan-beep.wav",e.beeper.appendChild(r)}function g(e,r,g,w,h){F.scanSettings=g,F.overlay=a(),l(h,F.overlay),F.isFullScreen=!w.landscapeMargins&&!w.portraitMargins,v(F),F.continuousMode=w.continuousMode,F.cancelCallback=r;var m=i(g);F.margins={landscapeMargins:w.landscapeMargins||[0,0,0,0],portraitMargins:w.portraitMargins||[0,0,0,0]};var b=n(F.margins);o(F.root,b);var S=t(F.overlay);c(b,g.scanningHotSpot,S,F.viewFinder,F.logo),document.addEventListener("visibilitychange",d),window.addEventListener("resize",p),F.isFullScreen&&!y()&&document.addEventListener("backbutton",P,!1),F.capture=new BarcodeScannerPlugin.Capture(m),null!==e&&F.capture.addDidScanDelegate(function(t){F.overlay.beep&&F.beeper.play(),e(t.session,{keepCallback:F.continuousMode}),F.continuousMode||f(),t.done()}),null!==F.cancelCallback&&F.capture.addFailDelegate(function(e){F.cancelCallback(e)}),F.capture.addOrientationChangedCallback(function(){F.capture&&s(F)}),F.capture.addRecognitionFailedDelegate(u)}function w(){F.preview.pause();var e=F.capture;return e.stopAsync().then(function(){return F.preview.src=null,e.closeAsync()})}function f(){if(null!=F.capture){F.running=!1;var e=F.root;w().then(function(){e&&document.body.removeChild(e),document.removeEventListener("visibilitychange",d),document.removeEventListener("backbutton",P),window.removeEventListener("resize",p),F.preview=null,F.capture=null,F.settings=null,F.margins=null,F.root=null,F.beeper=null,F.otherElements=null})}}function h(){F.capture&&(F.paused=!0,F.capture.pauseAsync())}function m(){F.capture&&(F.paused=!1,F.capture.resumeAsync())}function b(){F.capture&&F.preview&&(F.preview.removeEventListener("loadeddata",b),F.capture.startAsync(F.paused).then(function(){s(F)}))}function S(e){F.capture&&(F.running=!0,F.capture.initAsync().then(function(){F.capture&&(F.preview.src=URL.createObjectURL(F.capture.mediaCaptureSource),F.paused=e.paused,F.preview.addEventListener("loadeddata",b),F.preview.play())}))}function x(e){F.capture&&(F.margins=e,C())}function C(){if(null!==F.preview){var e=n(F.margins);o(F.root,e);var i=t(F.overlay);c(e,F.scanSettings.scanningHotSpot,i,F.viewFinder,F.logo),s(F)}}function P(){F.capture&&(F.cancelCallback&&F.cancelCallback("Canceled",{keepCallback:!0}),f())}function k(e){if(F.capture){var t=i(e);F.capture.applySettingsAsync(t)}}var F={root:null,preview:null,capture:null,settings:null,scanSettings:null,margins:null,deviceOrientationChangeListener:null,continuousMode:!1,cancelCallback:null,paused:!1,running:!1,startOnWindowVisible:!1};return{show:function(e,t,n){g(e,t,n[0],n[1],n[2])},cancel:function(){P()},start:function(e,t,n){S(n[0])},initLicense:function(e,t,n){BarcodeScannerPlugin.Capture.appKey=n[0]},applySettings:function(e,t,n){k(n[0])},stop:function(){h(),w()},pause:function(){h()},resume:function(){m()},torch:function(){},updateOverlay:function(e,i,r){l(r[0],F.overlay);var o=t(F.overlay);c(n(F.margins),F.scanSettings.scanningHotSpot,o,F.viewFinder,F.logo)},resize:function(e,t,n){F.isFullScreen||x(n[0])}}}();cordova.commandProxy.add("ScanditSDK",ScanditSDKProxy);